import React, {Component} from 'react';
import { Legend, PieChart, Tooltip, Pie, Sector, Cell } from 'recharts'
import FlatButton from 'material-ui/FlatButton';
import VulnerabilityDialog from '../vulnerability/VulnerabilityDialog'


const VULNERABLE = '#F44336'

const flatten = (arr) => {
	return Array.prototype.concat(...arr)
}

const deduplicate = (arr, key) => {
	return arr.filter((tt, index, self) => self.findIndex((t) => {return t[key] === tt[key] }) === index)
}
const ArtifactVulnerabilityList = ({ components, dialog, onVulnerabilityClose, onVulnerabilitySelect }) => {
	console.log(components.map((c) => c.vulnerabilities))
	const vulns = deduplicate(flatten(components.map((c) => c.vulnerabilities)), "id")

	const vulnerabilities = vulns.map((v) => <li key={v.id}><FlatButton label={v.id} onClick={() => onVulnerabilitySelect(v)} /></li>)
	
	console.log(dialog);
	if (vulnerabilities.length) {
		return (
			<div>
				<h2 style={{color: VULNERABLE }}>Vulnerabilities</h2>
				<ul>
					{vulnerabilities}
				</ul>

				<VulnerabilityDialog dialog={dialog} onClose={onVulnerabilityClose} />
			</div>
		)
	}
	return null
}

export default ArtifactVulnerabilityList